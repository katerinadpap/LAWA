In temporal-probabilistic (TP) databases, the combination of the temporal and the probabilistic dimension adds significant overhead to the computation of set operations. Although set queries are guaranteed to yield linearly sized output relations, all of the existing solutions exhibit a quadratic runtime complexity. They suffer from redundant interval comparisons and additional joins for the formation of lineage expressions.  

For the efficient computation of TP set operations, we introduce the lineage-aware temporal window, a mechanism that binds intervals with lineage expressions. A lineage-aware temporal window associates candidate output intervals with the lineage expressions of the valid input tuples. It has schema (F, winTs, winTe, lambda_r, lambda_s). F is a fact included in tuples over the interval [winTs, winTe). lambda_r and lambda_s are the lineage expressions of the input tuples of the left input relation r and the right input relation s, respectively, that are valid over [winTs, winTe) and include F. The flexibility of the lineage-aware temporal window is based on the fact that the lineages of  valid tuples of each input relation are separately recorded. Thus, the direct filtering of irrelevant intervals and the finalization of output lineage expressions are possible. Given a TP set operation, lambda_r and lambda_s can be used to determine if fact F and interval [winTs, winTe) yield an output tuple. If this is the case, lambda_r and lambda_s are combined accordingly to form the lineage expression of this output tuple. 

 In this repository, we have included the implementation of the lineage-aware window advancer (LAWA), a sweeping algorithm we introduce for producing lineage-aware temporal windows as well as the algorithms for the computation of TP set operations, that can now be performed in O(n logn) time.
 